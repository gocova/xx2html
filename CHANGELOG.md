# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]

### Added
- Added an API map to `README.md` for public and advanced integration entrypoints.
- Added/expanded docstrings across core modules to improve maintainability and release readability.
- Added coverage tests for edge cases in link rewriting and conditional-formatting class application.
- Added optional preview limits to `create_xlsx_transform`:
  - `max_sheets` (visible sheets), `max_rows`, and `max_cols`.
- Added optional `raise_on_error` mode to re-raise transform exceptions for caller-controlled error handling.
- Added CI quality gates for linting (`ruff`) and typing (`mypy`) in the main test workflow.
- Added generator metadata markers to output HTML:
  - `<meta name="generator" content="xx2html {version}">`
  - `<!-- Generated by xx2html {version} -->`

### Changed
- Standardized public transform API naming to `create_xlsx_transform`.
- Standardized internal `cova_` naming consistency in patch/render helpers.
- Centralized shared type aliases and typed render payloads in `src/xx2html/core/types.py`.
- Migrated project metadata URLs from Bitbucket to GitHub (`gocova/xx2html`).
- Switched package versioning to SCM/tag-driven versioning for SemVer-based stable releases.
- Updated CI/release automation to GitHub Actions with separate `ci` and `publish` workflows.
- Raised coverage quality gate from 60% to 85%.
- Refactored HTML post-processing to reuse a single parsed DOM for link rewriting and conditional-format class application.
- Refactored transform internals with explicit template validation and helper extraction for conditional-format relation building.
- Replaced direct destination writes with atomic write/replace output flow to avoid partial/truncated files on failures.

### Fixed
- Fixed local-sheet link rewriting for sheet names that contain dots (for example `#Q1.2026.A1`).
- Fixed local-sheet link rewriting for Excel-style internal anchors (for example `#'My Sheet'!A1`).
- Fixed unresolved local-sheet mappings to preserve original anchors instead of generating empty `href` values.
- Fixed conditional-formatting class merging to avoid duplicate classes and keep deterministic class ordering.
- Added an explicit openpyxl compatibility guard for monkey patches with a documented override env var (`XX2HTML_ALLOW_UNSUPPORTED_OPENPYXL=1`).
